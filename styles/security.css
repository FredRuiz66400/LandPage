/* S√âCURIT√â CSS - Protection contre les attaques CSS */

/* 1. Protection contre l'injection CSS - VERSION PR√âSERVANT L'IDENTIT√â */
/* Emp√™cher seulement l'injection de contenu malveillant sur les √©l√©ments sensibles */
input::before,
input::after,
form::before,
form::after {
    content: none !important;
}

/* 2. S√©curisation s√©lective des URLs - PR√âSERVER LES GRADIENTS */
/* Permettre les gradients et backgrounds l√©gitimes de OpenTalent */
input[style*="javascript:"],
form[style*="javascript:"],
*[style*="data:text/html"] {
    background-image: none !important;
}

/* 3. Protection contre les attaques de timing CSS */
/* D√©sactiver les animations sur les champs sensibles */
input[type="password"],
input[type="email"]:focus,
input[name="email"]:focus {
    animation: none !important;
    transition: none !important;
}

/* 4. Masquage s√©curis√© des donn√©es sensibles */
.hidden-sensitive {
    display: none !important;
    visibility: hidden !important;
    opacity: 0 !important;
    position: absolute !important;
    left: -9999px !important;
    width: 0 !important;
    height: 0 !important;
    overflow: hidden !important;
}

/* 5. Protection contre les attaques de mesure */
/* Emp√™cher la mesure pr√©cise de certains √©l√©ments */
.security-protected {
    box-sizing: border-box !important;
    width: auto !important;
    min-width: unset !important;
    max-width: unset !important;
}

/* 6. S√©curisation des transformations CSS */
/* Limiter les transformations pour √©viter les probl√®mes de rendu */
.safe-transform {
    transform: translateZ(0) !important;
    will-change: auto !important;
}

/* 7. Protection contre les d√©bordements malveillants */
.secure-container {
    overflow: hidden !important;
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
    hyphens: auto !important;
}

/* 8. Masquage des informations syst√®me */
/* Emp√™cher la d√©tection de fonts syst√®me */
.text-secure {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Inter', sans-serif !important;
}

/* 9. Protection contre les attaques de focus */
/* S√©curiser les √©tats de focus pour √©viter la d√©tection */
.form-field:focus {
    outline: 2px solid var(--primary-color) !important;
    outline-offset: 2px !important;
    box-shadow: 0 0 0 3px rgba(251, 113, 133, 0.1) !important;
}

/* 10. D√©sactiver les features CSS potentiellement dangereuses */
* {
    /* D√©sactiver les expressions CSS (IE) */
    behavior: none !important;
    /* D√©sactiver les bindings XBL (Firefox) */
    -moz-binding: none !important;
}

/* 11. Protection contre l'exfiltration de donn√©es via CSS */
/* Emp√™cher les s√©lecteurs d'attributs sensibles */
input[value*="password"],
input[value*="token"],
input[value*="secret"] {
    background: transparent !important;
    background-image: none !important;
    background-color: transparent !important;
}

/* 12. S√©curisation des media queries */
/* √âviter les media queries trop sp√©cifiques qui pourraient r√©v√©ler des infos */
@media (max-width: 768px) {
    .responsive-secure {
        display: block !important;
    }
}

/* Ne pas utiliser de media queries bas√©es sur des caract√©ristiques syst√®me pr√©cises */
/* √âviter: @media (device-width: 375px) - trop sp√©cifique */

/* 13. Protection contre les animations malveillantes */
/* Limiter les animations pour √©viter les attaques de phishing */
@keyframes secure-fade {
    from { opacity: 0; }
    to { opacity: 1; }
}

.secure-animation {
    animation: secure-fade 0.3s ease-in-out !important;
    animation-iteration-count: 1 !important;
    animation-fill-mode: forwards !important;
}

/* Interdire les animations infinies suspectes */
.no-infinite-animation {
    animation-iteration-count: 1 !important;
}

/* 14. S√©curisation des variables CSS */
/* S'assurer que les variables CSS ne peuvent pas √™tre inject√©es */
:root {
    --safe-primary: #fb7185;
    --safe-secondary: #f97316;
    --safe-background: #fffbeb;
}

/* 15. Protection des formulaires - PR√âSERVER LE STYLE */
/* Les attributs HTML seront g√©r√©s via JavaScript, pas CSS */
.form-secure input {
    /* S√©curit√© sans casser le style */
    position: relative;
}

/* Protection contre les attaques de type "form hijacking" */
form {
    isolation: isolate !important;
    contain: layout style !important;
}

/* 16. S√©curisation des liens - G√âR√â VIA JAVASCRIPT */
/* Les attributs rel seront ajout√©s via JavaScript pour pr√©server le CSS */
a[href^="javascript:"] {
    pointer-events: none !important;
    display: none !important;
}

/* 17. Protection contre les attaques de mesure de temps */
/* Standardiser les temps de rendu */
.consistent-timing {
    transition-duration: 0.2s !important;
    animation-duration: 0.3s !important;
}

/* 18. Masquage des erreurs CSS */
/* √âviter que les erreurs CSS r√©v√®lent des informations */
.error-safe {
    background: var(--safe-background, #fff) !important;
    color: var(--safe-text, #333) !important;
}

/* 19. Protection contre les s√©lecteurs dynamiques */
/* √âviter les s√©lecteurs qui pourraient √™tre exploit√©s */
.dynamic-content[data-value] {
    content: none !important;
}

/* 20. R√®gles de nettoyage final */
/* Nettoyer tout contenu potentiellement dangereux */
script,
style:not([data-secure="true"]),
link[rel="stylesheet"]:not([data-secure="true"]) {
    display: none !important;
    visibility: hidden !important;
}

/* Classes utilitaires s√©curis√©es */
.sr-only-secure {
    position: absolute !important;
    width: 1px !important;
    height: 1px !important;
    padding: 0 !important;
    margin: -1px !important;
    overflow: hidden !important;
    clip: rect(0, 0, 0, 0) !important;
    white-space: nowrap !important;
    border: 0 !important;
}

/* Style pour les messages de s√©curit√© */
.security-warning {
    background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%) !important;
    border: 1px solid #fca5a5 !important;
    color: #dc2626 !important;
    padding: 12px 16px !important;
    border-radius: 8px !important;
    font-size: 14px !important;
    margin: 8px 0 !important;
    position: relative !important;
}

.security-warning::before {
    content: "üîí " !important;
    font-weight: bold !important;
}

/* Protection finale contre l'injection */
/* Cette r√®gle doit √™tre la derni√®re - MAIS pr√©serve l'identit√© visuelle */
script:not([src]),
style:not([data-secure="true"]) {
    display: none !important;
}

/* NE PAS r√©initialiser le CSS principal - pr√©server l'identit√© visuelle */